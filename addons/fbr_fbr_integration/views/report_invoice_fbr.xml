<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <template id="report_invoice_document_inherit_fbr_di_totals" inherit_id="account.report_invoice_document">
    <!-- Put after the native totals box; common anchor: last page container -->
    <xpath expr="(//div[contains(concat(' ', normalize-space(@class), ' '), ' page ')])[last()]" position="inside">
      <t t-if="o.move_type in ('out_invoice','out_refund')">
        <table style="margin-top:8px; width:100%; border-collapse:collapse;">
          <tbody>
            <tr>
              <td style="text-align:right; padding:2px 0;">Extra Tax Total:</td>
              <td style="text-align:right; padding:2px 0; width:120px;">
                <span t-esc="o.currency_id.symbol"/>
                <span t-esc="o.amount_extra_tax"/>
              </td>
            </tr>
            <tr>
              <td style="text-align:right; padding:2px 0;">Further Tax Total:</td>
              <td style="text-align:right; padding:2px 0;">
                <span t-esc="o.currency_id.symbol"/>
                <span t-esc="o.amount_further_tax"/>
              </td>
            </tr>
            <tr>
              <td style="text-align:right; padding:2px 0; font-weight:700;">Grand Total (Incl. Extra+Further):</td>
              <td style="text-align:right; padding:2px 0; font-weight:700;">
                <span t-esc="o.currency_id.symbol"/>
                <span t-esc="o.amount_total_with_all"/>
              </td>
            </tr>
          </tbody>
        </table>
      </t>
    </xpath>
  </template>
</odoo>
